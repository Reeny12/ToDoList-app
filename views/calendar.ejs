<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    >
    <link rel="stylesheet" href="/calendar.css">
</head>
<body>
    <nav class="navbar navbar-light bg-light">
        <a class="navbar-brand" href="/">Home</a>
        <a class="navbar-brand" href="/about">About</a>
        <a class="navbar-brand" href="/calendar">Calendar</a>
    </nav>
  <div class="calendar">
      <div class="month">
          <h2><%= new Date(currentYear, currentMonth - 1).toLocaleString('default', { month: 'long' }) %> <%= currentYear %></h2>
          
      </div>
      <div class="weekdays">
          <div>Sun</div>
          <div>Mon</div>
          <div>Tue</div>
          <div>Wed</div>
          <div>Thu</div>
          <div>Fri</div>
          <div>Sat</div>
      </div>
      <div class="days">
        <% for (let i = 1; i <= daysInMonth; i++) { %>
            <div class="day">
                <%= i %>
                <% let date = new Date(currentYear, currentMonth - 1, i); %>
                <% todos.forEach(todo => { 
                    if (new Date(todo.dueDate).getDate() === i && new Date(todo.dueDate).getMonth() === currentMonth - 1) { %>
                        <div class="task">
                            <%= todo.todo %> - Due at <%= todo.dueDate.toLocaleTimeString() %>
                        </div>
                    <% } 
                    
                }) %>
            </div>
        <% } %>
    </div>
</div>

<div class="clock" id="clock"></div>
  </div>

<script>
    function updateTime() {
      const now = new Date();
      let hours = now.getHours();
      let minutes = now.getMinutes();
      let seconds = now.getSeconds();

      // Format time to be two digits
      hours = hours < 10 ? "0" + hours : hours;
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;

      // Update the time in the DOM
      document.getElementById("clock").textContent = `Current Time: ${hours}:${minutes}:${seconds}`;
    }

    // Update the time every second
    setInterval(updateTime, 1000);

    // Call the function initially to display time immediately
    updateTime();
  </script>
  
  <div class="navigation">
    <!-- Navigation for Previous Month -->
    <a href="/calendar/<%= currentMonth === 1 ? currentYear - 1 : currentYear %>/<%= currentMonth === 1 ? 12 : currentMonth - 1 %>">Previous Month</a> 
    |
    <!-- Navigation for Next Month -->
    <a href="/calendar/<%= currentMonth === 12 ? currentYear + 1 : currentYear %>/<%= currentMonth === 12 ? 1 : currentMonth + 1 %>">Next Month</a>
  </div>
</body>
</html>
